<!doctype html><html lang=en-US dir=ltr><head><meta charset=utf-8><meta name=viewport content="initial-scale=1,width=device-width"><link rel=icon type=image/png sizes=32x32 href=/blog/favicons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/blog/favicons/favicon-16x16.png><link rel="shortcut icon" href=/blog/favicons/favicon.ico><title>On CFrame vectors | Anaminus.Blog</title><meta name=twitter:card content="summary"><meta name=twitter:title content="On CFrame vectors | Anaminus.Blog"><meta name=twitter:description content="Correcting documentation on CFrames."><meta name=twitter:image content="https://anaminus.github.io/blog/favicons/favicon-512x512.png"><meta property="og:type" content="website"><meta property="og:title" content="On CFrame vectors | Anaminus.Blog"><meta property="og:description" content="Correcting documentation on CFrames."><meta property="og:image" content="https://anaminus.github.io/blog/favicons/favicon-512x512.png"><link rel=stylesheet href=/blog/main.min.8856ad9922a20bcadfe4d0845af8f0906dea160014c30c6fe73da54094a38c6f.css integrity="sha256-iFatmSKiC8rf5NCEWvjwkG3qFgAUwwxv5z2lQJSjjG8=" crossorigin=anonymous></head><body><header><a href=https://anaminus.github.io/blog/><svg class="header" width="43" height="9" viewBox="0 0 43 9"><title>Logo with title ".Blog"</title><path class="logo" d="m2 1v1H1v3h1v3h1V7h1v1h1V5h1V2H5V1H4v1H3V1zm0 2h1v1H2zm2 0h1v1H4z"/><path class="title" d="m13 1v7h4V7h-3V5h3V4h-3V2h3V1zm4 1v2h1V2zm0 3v2h1V5zm2-2v5h5V7h-4V3zm7 0v1h3V3zm3 1v3h1V4zm0 3h-3v1h3zm-3 0V4h-1v3zm6-4v1h4V3zm0 1h-1v3h1zm0 3v1h3V7zm3 0h1V5h-3v1h2zM9 7v1h1V7z"/><path class="cursor" d="m37 8h5v1h-5z"/></svg></a></header><main><nav><a href=https://anaminus.github.io/blog/posts/>Posts</a></nav><article><header><div class=title><h1>On CFrame vectors</h1><span class=date>Published on <time>2023-01-29</time></span></div><div class=subtitle><div class=description>Correcting documentation on CFrames.</div><span class=tags><a class=tag href=https://anaminus.github.io/blog/tags/roblox/>#roblox</a></span></div></header><p>In Roblox, the <a href=https://create.roblox.com/docs/reference/engine/datatypes/CFrame>CFrame</a> type has several &ldquo;Vector&rdquo; fields representing
the directions of various axes of the CFrame. There are two sets of 3 vectors:</p><ul><li><a href=https://create.roblox.com/docs/reference/engine/datatypes/CFrame#RightVector>RightVector</a>, <a href=https://create.roblox.com/docs/reference/engine/datatypes/CFrame#UpVector>UpVector</a>, <a href=https://create.roblox.com/docs/reference/engine/datatypes/CFrame#LookVector>LookVector</a></li><li><a href=https://create.roblox.com/docs/reference/engine/datatypes/CFrame#XVector>XVector</a>, <a href=https://create.roblox.com/docs/reference/engine/datatypes/CFrame#YVector>YVector</a>, <a href=https://create.roblox.com/docs/reference/engine/datatypes/CFrame#ZVector>ZVector</a></li></ul><p>Roblox&rsquo;s documentation claims that these fields represent the rows and columns
of the CFrame&rsquo;s rotation matrix. The X, Y, Z fields are the rows, and the Right,
Up, Look fields are the columns. <strong>This is very significantly incorrect</strong>.
Inspecting the values of each component reveals it so:</p><pre><code>CFrame.identity:GetComponents()
	0 0 0 1 0 0 0 1 0 0 0 1

CFrame.identity.Position
	0 0 0

CFrame.identity.XVector
	1 0 0

CFrame.identity.YVector
	0 1 0

CFrame.identity.ZVector
	0 0 1

CFrame.identity.RightVector
	1 0 0

CFrame.identity.UpVector
	0 1 0

CFrame.identity.LookVector
	-0 -0 -1
</code></pre><p>What we can see is that the X-, Y- and ZVector fields correspond directly to the
components:</p><pre><code>Fields      [Position][XVector][YVector][ZVector]
Components  0, 0, 0,  1, 0, 0, 0, 1, 0, 0, 0, 1
</code></pre><p>We also notice some other things:</p><ul><li>RightVector and UpVector appear to be redundant with XVector and YVector.</li><li>LookVector always equal to -ZVector.</li></ul><p>Why would it be like this? Is the implementation incorrect?</p><p>Nope. The explanation is that the X-, Y-, and ZVector fields represent the raw
components of the CFrame matrix, while the Right-, Up- and LookVector fields
represent more practical values.</p><p>Originally, CFrames had only the LookVector field (stylized as <code>lookVector</code>). It
represents the most interesting vector, being the &ldquo;front&rdquo; face of the CFrame, or
the direction the CFrame was &ldquo;looking&rdquo;. Very useful for getting things to look
at or move towards other things. For whatever reason, Roblox defined the front
face to be the <em>complement</em> of the Z direction.</p><p>Eventually, the other vector fields were added. RightVector and UpVector were
added as counterparts to LookVector. However, to correctly derive the raw
components from these vectors, one would have to remember to invert the
LookVector.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lua data-lang=lua><span class=line><span class=cl><span class=kd>local</span> <span class=n>right</span> <span class=o>=</span> <span class=n>cframe.RightVector</span>
</span></span><span class=line><span class=cl><span class=kd>local</span> <span class=n>up</span> <span class=o>=</span> <span class=n>cframe.UpVector</span>
</span></span><span class=line><span class=cl><span class=kd>local</span> <span class=n>lookaway</span> <span class=o>=</span> <span class=o>-</span><span class=n>cframe.LookVector</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>local</span> <span class=n>r00</span><span class=p>,</span> <span class=n>r01</span><span class=p>,</span> <span class=n>r02</span> <span class=o>=</span> <span class=n>right.X</span><span class=p>,</span> <span class=n>right.Y</span><span class=p>,</span> <span class=n>right.Z</span>
</span></span><span class=line><span class=cl><span class=kd>local</span> <span class=n>r10</span><span class=p>,</span> <span class=n>r11</span><span class=p>,</span> <span class=n>r12</span> <span class=o>=</span> <span class=n>up.X</span><span class=p>,</span> <span class=n>up.Y</span><span class=p>,</span> <span class=n>up.Z</span>
</span></span><span class=line><span class=cl><span class=kd>local</span> <span class=n>r20</span><span class=p>,</span> <span class=n>r21</span><span class=p>,</span> <span class=n>r22</span> <span class=o>=</span> <span class=n>lookaway.X</span><span class=p>,</span> <span class=n>lookaway.Y</span><span class=p>,</span> <span class=n>lookaway.Z</span>
</span></span></code></pre></div><p>Because this would be confusing and easy to forget, the ZVector field was added
to represent the raw Z direction, along with XVector and YVector as
counterparts. This explains the redundancy of XVector/RightVector and
YVector/UpVector.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lua data-lang=lua><span class=line><span class=cl><span class=kd>local</span> <span class=n>x</span> <span class=o>=</span> <span class=n>cframe.XVector</span>
</span></span><span class=line><span class=cl><span class=kd>local</span> <span class=n>y</span> <span class=o>=</span> <span class=n>cframe.YVector</span>
</span></span><span class=line><span class=cl><span class=kd>local</span> <span class=n>z</span> <span class=o>=</span> <span class=n>cframe.ZVector</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>local</span> <span class=n>r00</span><span class=p>,</span> <span class=n>r01</span><span class=p>,</span> <span class=n>r02</span> <span class=o>=</span> <span class=n>x.X</span><span class=p>,</span> <span class=n>x.Y</span><span class=p>,</span> <span class=n>x.Z</span>
</span></span><span class=line><span class=cl><span class=kd>local</span> <span class=n>r10</span><span class=p>,</span> <span class=n>r11</span><span class=p>,</span> <span class=n>r12</span> <span class=o>=</span> <span class=n>y.X</span><span class=p>,</span> <span class=n>y.Y</span><span class=p>,</span> <span class=n>y.Z</span>
</span></span><span class=line><span class=cl><span class=kd>local</span> <span class=n>r20</span><span class=p>,</span> <span class=n>r21</span><span class=p>,</span> <span class=n>r22</span> <span class=o>=</span> <span class=n>z.X</span><span class=p>,</span> <span class=n>z.Y</span><span class=p>,</span> <span class=n>z.Z</span>
</span></span></code></pre></div><p>To summarize, RightVector is always equal to XVector, UpVector is always equal
to YVector, and LookVector is always equal to the complement of ZVector. And
don&rsquo;t let the documentation let you think otherwise.</p><pre><code>RightVector ==  XVector
UpVector    ==  YVector
LookVector  == -ZVector
</code></pre></article></main><footer><span class=license>Content is licensed under <a href=https://creativecommons.org/licenses/by-sa/4.0/>CC BY-SA-4.0</a><a class=feed-icon title="RSS feed" href=https://anaminus.github.io/blog/index.xml><svg width="128" height="128" viewBox="0 0 256 256"><path d="m92 189a24 24 0 01-24 24 24 24 0 01-24-24 24 24 0 0124-24 24 24 0 0124 24z"/><path d="m160 213h-34a82 82 0 00-82-82V97a116 116 0 01116 116z"/><path d="M184 213A140 140 0 0044 73V38a175 175 0 01175 175z"/></svg></a></span>
<span class=publication><svg viewBox="0 0 7 7" width="7" height="7"><path d="m2 0v1H1v3h1v3h1V6h1v1h1V4h1V1H5V0H4v1H3V0zm0 2h1v1H2zm2 0h1v1H4z"/></svg> 2022â€“2025 <a href=https://anaminus.github.io/>Anaminus</a></span></footer></body></html>