<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Blog posts from Anaminus"><link rel="shortcut icon" href=https://anaminus.github.io/blog/favicon.ico><link rel=stylesheet href=/blog/css/style.min.css><title>Securing secret branches</title></head><body><header id=banner><h2><a href=https://anaminus.github.io/blog>Blog</a></h2><nav><ul><li><a href=/blog/ title=posts>posts</a></li><li><a href=/blog/about/ title=about>about</a></li></ul></nav></header><main id=content><article><header id=post-header><h1>Securing secret branches</h1><div><time>Nov 6, 2022</time></div></header><p>Most posts I write will never be published. But I still keep them around
locally, because they often contain useful bits that will likely find their way
into another post.</p><p>The blog is managed by git. When I want to publish a new post, I just commit and
push (&ldquo;pushlish&rdquo;?). I keep drafts on a separate branch that stays local.</p><p>But how do I make sure it stays local? I don&rsquo;t want to accidentally push super
secret drafts to GitHub! Fortunately, GitHub has what are called &ldquo;Protection
rules&rdquo;.</p><p>To set it up, first the branch needs to be on GitHub. It&rsquo;s easy enough to create
a new branch on the website by going to the <code>/branches</code> page.</p><p><img src=fig1.png alt></p><p>The branch has to be based off of another one. I used the same branch as what my
local <code>drafts</code> branch is based off of. This will make accidental pulls safe,
since git will just think the local branch is the latest.</p><p>Next, I went to Settings, then Branches, and added a new Branch protection rule,
where the pattern matched the name of the branch:</p><p><img src=fig2.png alt></p><p>Then I included the Lock branch rule. This will prevent me from pushing to it. I
also included the &ldquo;Do not allow bypassing above settings&rdquo;. Seems like a safe
thing to do.</p><p><img src=fig3.png alt></p><p>Saved the rule, and that&rsquo;s it.</p><p><img src=fig4.png alt></p><p>Now when I try to push to the branch, GitHub will reject the attempt.</p><p><img src=fig5.png alt></p><p>Notably, git still tries to upload everything, and the rejection comes
afterwards. I could add a local pre-push hook to prevent the uploading, but I&rsquo;m
not worried about it. The point is to prevent the drafts from becoming public,
which has already been accomplished.</p></article></main><footer id=footer>Copyright Â© 2022 Anaminus</footer></body></html>