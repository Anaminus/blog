<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Blog posts from Anaminus"><link rel="shortcut icon" href=https://anaminus.github.io/blog/favicon.ico><link rel=stylesheet href=/blog/css/style.min.css><link rel=canonical href=https://anaminus.github.io/blog/on-cframe-vectors/><title>On CFrame vectors</title></head><body><header id=banner><h2><a href=https://anaminus.github.io/blog/>Blog</a></h2><nav><ul><li><a href=/blog/ title=posts>posts</a></li><li><a href=/blog/about/ title=about>about</a></li></ul></nav></header><main id=content><article><header id=post-header><h1>On CFrame vectors</h1><div><time>January 29, 2023</time></div></header><p>In Roblox, the <a href=https://create.roblox.com/docs/reference/engine/datatypes/CFrame>CFrame</a> type has several &ldquo;Vector&rdquo; fields representing
the directions of various axes of the CFrame. There are two sets of 3 vectors:</p><ul><li><a href=https://create.roblox.com/docs/reference/engine/datatypes/CFrame#RightVector>RightVector</a>, <a href=https://create.roblox.com/docs/reference/engine/datatypes/CFrame#UpVector>UpVector</a>, <a href=https://create.roblox.com/docs/reference/engine/datatypes/CFrame#LookVector>LookVector</a></li><li><a href=https://create.roblox.com/docs/reference/engine/datatypes/CFrame#XVector>XVector</a>, <a href=https://create.roblox.com/docs/reference/engine/datatypes/CFrame#YVector>YVector</a>, <a href=https://create.roblox.com/docs/reference/engine/datatypes/CFrame#ZVector>ZVector</a></li></ul><p>Roblox&rsquo;s documentation claims that these fields represent the rows and columns
of the CFrame&rsquo;s rotation matrix. The X, Y, Z fields are the rows, and the Right,
Up, Look fields are the columns. <strong>This is very significantly incorrect</strong>.
Inspecting the values of each component reveals it so:</p><pre><code>CFrame.identity:GetComponents()
	0 0 0 1 0 0 0 1 0 0 0 1

CFrame.identity.Position
	0 0 0

CFrame.identity.XVector
	1 0 0

CFrame.identity.YVector
	0 1 0

CFrame.identity.ZVector
	0 0 1

CFrame.identity.RightVector
	1 0 0

CFrame.identity.UpVector
	0 1 0

CFrame.identity.LookVector
	-0 -0 -1
</code></pre><p>What we can see is that the X-, Y- and ZVector fields correspond directly to the
components:</p><pre><code>Fields      [Position][XVector][YVector][ZVector]
Components  0, 0, 0,  1, 0, 0, 0, 1, 0, 0, 0, 1
</code></pre><p>We also notice some other things:</p><ul><li>RightVector and UpVector appear to be redundant with XVector and YVector.</li><li>LookVector always equal to -ZVector.</li></ul><p>Why would it be like this? Is the implementation incorrect?</p><p>Nope. The explanation is that the X-, Y-, and ZVector fields represent the raw
components of the CFrame matrix, while the Right-, Up- and LookVector fields
represent more practical values.</p><p>Originally, CFrames had only the LookVector field (stylized as <code>lookVector</code>). It
represents the most interesting vector, being the &ldquo;front&rdquo; face of the CFrame, or
the direction the CFrame was &ldquo;looking&rdquo;. Very useful for getting things to look
at or move towards other things. For whatever reason, Roblox defined the front
face to be the <em>complement</em> of the Z direction.</p><p>Eventually, the other vector fields were added. RightVector and UpVector were
added as counterparts to LookVector. However, to correctly derive the raw
components from these vectors, one would have to remember to invert the
LookVector.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lua data-lang=lua><span class=line><span class=cl><span class=kd>local</span> <span class=n>right</span> <span class=o>=</span> <span class=n>cframe.RightVector</span>
</span></span><span class=line><span class=cl><span class=kd>local</span> <span class=n>up</span> <span class=o>=</span> <span class=n>cframe.UpVector</span>
</span></span><span class=line><span class=cl><span class=kd>local</span> <span class=n>lookaway</span> <span class=o>=</span> <span class=o>-</span><span class=n>cframe.LookVector</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>local</span> <span class=n>r00</span><span class=p>,</span> <span class=n>r01</span><span class=p>,</span> <span class=n>r02</span> <span class=o>=</span> <span class=n>right.X</span><span class=p>,</span> <span class=n>right.Y</span><span class=p>,</span> <span class=n>right.Z</span>
</span></span><span class=line><span class=cl><span class=kd>local</span> <span class=n>r10</span><span class=p>,</span> <span class=n>r11</span><span class=p>,</span> <span class=n>r12</span> <span class=o>=</span> <span class=n>up.X</span><span class=p>,</span> <span class=n>up.Y</span><span class=p>,</span> <span class=n>up.Z</span>
</span></span><span class=line><span class=cl><span class=kd>local</span> <span class=n>r20</span><span class=p>,</span> <span class=n>r21</span><span class=p>,</span> <span class=n>r22</span> <span class=o>=</span> <span class=n>lookaway.X</span><span class=p>,</span> <span class=n>lookaway.Y</span><span class=p>,</span> <span class=n>lookaway.Z</span>
</span></span></code></pre></div><p>Because this would be confusing and easy to forget, the ZVector field was added
to represent the raw Z direction, along with XVector and YVector as
counterparts. This explains the redundancy of XVector/RightVector and
YVector/UpVector.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lua data-lang=lua><span class=line><span class=cl><span class=kd>local</span> <span class=n>x</span> <span class=o>=</span> <span class=n>cframe.XVector</span>
</span></span><span class=line><span class=cl><span class=kd>local</span> <span class=n>y</span> <span class=o>=</span> <span class=n>cframe.YVector</span>
</span></span><span class=line><span class=cl><span class=kd>local</span> <span class=n>z</span> <span class=o>=</span> <span class=n>cframe.ZVector</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>local</span> <span class=n>r00</span><span class=p>,</span> <span class=n>r01</span><span class=p>,</span> <span class=n>r02</span> <span class=o>=</span> <span class=n>x.X</span><span class=p>,</span> <span class=n>x.Y</span><span class=p>,</span> <span class=n>x.Z</span>
</span></span><span class=line><span class=cl><span class=kd>local</span> <span class=n>r10</span><span class=p>,</span> <span class=n>r11</span><span class=p>,</span> <span class=n>r12</span> <span class=o>=</span> <span class=n>y.X</span><span class=p>,</span> <span class=n>y.Y</span><span class=p>,</span> <span class=n>y.Z</span>
</span></span><span class=line><span class=cl><span class=kd>local</span> <span class=n>r20</span><span class=p>,</span> <span class=n>r21</span><span class=p>,</span> <span class=n>r22</span> <span class=o>=</span> <span class=n>z.X</span><span class=p>,</span> <span class=n>z.Y</span><span class=p>,</span> <span class=n>z.Z</span>
</span></span></code></pre></div><p>To summarize, RightVector is always equal to XVector, UpVector is always equal
to YVector, and LookVector is always equal to the complement of ZVector. And
don&rsquo;t let the documentation let you think otherwise.</p><pre><code>RightVector ==  XVector
UpVector    ==  YVector
LookVector  == -ZVector
</code></pre></article></main><footer id=footer>Copyright Â© 2022 Anaminus</footer></body></html>